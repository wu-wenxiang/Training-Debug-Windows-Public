## 准备工作、工具、环境和Demo
- 环境：
	- OS：Win7 / Win8.1 / Win10
	- IDE：VS2015 / VS2017
- 源码：[Github](https://github.com/wu-wenxiang/Training-Debug-Windows-Public/tree/master/src)，[下载](https://github.com/wu-wenxiang/Training-Debug-Windows-Public/archive/master.zip)

## Microsoft Media Foundation
- Overview
	- [Overview of the Media Foundation Architecture](https://docs.microsoft.com/en-us/windows/desktop/medfound/overview-of-the-media-foundation-architecture)
		- COM-based multimedia framework pipeline and infrastructure platform for digital media. 
		- The intended replacement for Microsoft DirectShow, Windows Media SDK, DirectX Media Objects (DMOs) and all other so-called "legacy" multimedia APIs such as Audio Compression Manager (ACM) and Video for Windows (VfW). 
		- ![MFoundation.svg.png](https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/MFoundation.svg/720px-MFoundation.svg.png)
		- ![MF-architecture.png](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/mfarch01.png)
	- [Overview of Encoding in Media Foundation](https://docs.microsoft.com/en-us/windows/desktop/medfound/overview-of-encoding-in-media-foundation)
		- ![encoding03.png](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/encoding03.png)
		- ![encoding05.png](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/encoding05.png)
		- Media Foundation Encoding Architecture
		- ![encoding04.png](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/encoding04.png)
		- [Media Session](https://docs.microsoft.com/en-us/windows/desktop/medfound/about-the-media-session)
		- ![encoding01.png](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/encoding01.png)
		- [Source Reader](https://docs.microsoft.com/en-us/windows/desktop/medfound/source-reader) & [Sink Writer](https://docs.microsoft.com/en-us/windows/desktop/medfound/sink-writer)
		- ![encoding02.png](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/encoding02.png)
	- [What's New for Media Foundation](https://docs.microsoft.com/en-us/windows/desktop/medfound/whats-new-for-media-foundation), [Win7](https://msdn.microsoft.com/zh-cn/library/ee461351.aspx)
- Tools
	- [MFTrace](https://docs.microsoft.com/en-us/windows/desktop/medfound/using-mftrace) is a tool for generating trace logs for Media Foundation applications
		- MFTrace uses the Detours library to hook into Media Foundation API calls and generate trace logs. 
		- MFTrace can also record traces from any component that uses Event Tracing for Windows (ETW) or the software trace preprocessor (WPP) to generate traces.
		- Onlaunch: `mftrace.exe wmplayer.exe Wildlife.wmv`
		- Attach: `mftrace.exe -a wmplayer.exe -o trace.txt`
	- [TopoEdit](https://docs.microsoft.com/en-us/windows/desktop/medfound/introduction-to-topoedit) is a visual tool for testing Media Foundation components
		- [关于拓扑](https://docs.microsoft.com/en-us/windows/desktop/medfound/about-topologies)
		- ![topology01.png](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/topology01.png)
		- [building topologies by using topoedit](https://docs.microsoft.com/en-us/windows/desktop/medfound/building-topologies-by-using-topoedit)
		- ![Topo.gif](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/e94b4cce-aa8a-497f-94c2-cc9dace17291.gif)
		- ![topo.png](https://raw.githubusercontent.com/wu-wenxiang/Media-WebLink/master/qiniu/8661eb768fee4b91b78cc8470be5ac02-topo.png)
	- Performance: [Xperf](https://blogs.msdn.microsoft.com/ntdebugging/2008/04/03/windows-performance-toolkit-xperf/), [GPUView](https://docs.microsoft.com/en-us/windows-hardware/drivers/display/using-gpuview), [UIforETW](https://github.com/google/UIforETW/releases) 
	- [Sysinternals](https://docs.microsoft.com/en-us/sysinternals/downloads): Procdump, Procmon, ProcExp
- Media Foundation Programming Guide
	- [Media Foundation: Essential Concepts](https://docs.microsoft.com/en-us/windows/desktop/medfound/media-foundation-programming--essential-concepts)
		- Streams：最常见的类型是音频和视频，视频文件可能包含一个视频流和几种不同语言的音频流
		- Compression：压缩也称为编码，反向过程是解码。对应的设备是编码器/解码器。
		- Media Containers
			- ![MediaContainers.png](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/concepts01.png)
		- Formats
			- ![Decoder.png](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/concepts02.png)
			- ![Encoder.png](https://docs.microsoft.com/en-us/windows/desktop/medfound/images/concepts03.png)
	- Audio/Video Capture
- Media Foundation SDK Samples
	- [MFCaptureToFile Sample](https://docs.microsoft.com/en-us/windows/desktop/medfound/mfcapturetofile-sample)
	- [SimpleCapture Sample](https://docs.microsoft.com/en-us/windows/desktop/medfound/simplecapture-sample)
	- [MFT-Audiodelay Sample](https://docs.microsoft.com/en-us/windows/desktop/medfound/mft-audiodelay-sample)
	- [Transcode Sample](https://docs.microsoft.com/en-us/windows/desktop/medfound/transcode-sample)
- Questions
	- topology中添加mp4的encoder步骤（以media session和topology的形式实现采集摄像头并保存为mp4文件）
		- [Transcode Sample](https://docs.microsoft.com/en-us/windows/desktop/medfound/transcode-sample)
		- [Tutorial: Encoding an MP4 File](https://docs.microsoft.com/en-us/windows/desktop/medfound/tutorial--encoding-an-mp4-file-)
		- [Tutorial: Using the Sink Writer to Encode Video](https://docs.microsoft.com/en-us/windows/desktop/medfound/tutorial--using-the-sink-writer-to-encode-video)
	- media session对topology中的节点，部分节点启动，部分节点停止是否支持。如果支持如何做
		- Suppose no, need check
	- fmt中如果有多个input；streamid分别为0、1、2、3。media session启动后如果mft只request streamid为0的数据流其他不request，会有什么问题?
		- Suppose no issue, need test
	- topology中如果某个media source节点流结束或异常中断。整个media session是否会出现异常。
		- Hang or crash, could test & Dump debug
	- 重新构建topology是否需要先停止media session?
		- [Advanced Topology Building](https://docs.microsoft.com/en-us/windows/desktop/medfound/advanced-topology-building)
